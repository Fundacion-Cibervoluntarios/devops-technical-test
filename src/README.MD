# E-commerce Application - DevOps Technical Test

Simple e-commerce application designed for DevOps technical assessment.

## üèóÔ∏è Architecture

- **Frontend**: React SPA (port 3000) with product catalog and shopping cart
- **Backend**: Node.js/Express REST API (port 8080) with health endpoints
- **Database**: PostgreSQL (Azure Database when deployed)
- **Cache**: Redis (Azure Redis when deployed)

## üöÄ Quick Start

### Option 1: Docker Compose (Recommended)
```bash
# Start complete environment
docker-compose up

# Access:
# Frontend: http://localhost:3000
# Backend API: http://localhost:8080
# Health check: http://localhost:8080/health
```

### Option 2: Development Mode
```bash
# Terminal 1 - Backend
cd backend
npm install
npm start

# Terminal 2 - Frontend  
cd frontend
npm install
npm start
```

# üîç Health Checks

La aplicaci√≥n incluye endpoints de health para Kubernetes:

- **Frontend Health:** `GET /health` (endpoint de nginx)
- **Frontend Readiness:** `GET /ready` (endpoint de nginx)
- **Backend Health:** `GET /health` (estado de la aplicaci√≥n)
- **Backend Readiness:** `GET /ready` (check de dependencias)

---

# üì° API Endpoints

- `GET /health` ‚Äì Estado de la aplicaci√≥n
- `GET /ready` ‚Äì Readiness check (database, redis)
- `GET /api/products` ‚Äì Listado de productos
- `POST /api/cart` ‚Äì A√±adir producto al carrito
- `GET /api/cart` ‚Äì Consultar carrito
- `GET /metrics` ‚Äì M√©tricas (uptime, memoria)

---

# üê≥ Container Details

**Frontend**
- Base: `nginx:alpine`
- Puerto: 3000
- Health Check: Built-in nginx health endpoint
- Multi-stage: Build con Node.js ‚Üí Servido con nginx

**Backend**
- Base: `node:18-alpine`
- Puerto: 8080
- Usuario: Non-root (`nodeuser:1001`)
- Health Check: HTTP GET `/health`

---

# ‚ò∏Ô∏è Kubernetes Deployment

Aplicaci√≥n pensada para ejecutarse en Azure AKS.

## Resource Requirements

| Componente | CPU (requests/limits) | RAM (requests/limits) |
|------------|---------------------- |----------------------|
| Frontend   | 100m / 200m           | 128Mi / 256Mi        |
| Backend    | 200m / 500m           | 256Mi / 512Mi        |

## External Dependencies

- **PostgreSQL:** Azure Database for PostgreSQL Flexible Server
- **Redis:** Azure Redis Cache
- **Storage:** Azure Files (para uploads si aplica)

## Health Checks Configuration

**Frontend probe example**
<pre>
livenessProbe:
  httpGet:
    path: /health
    port: 3000
  initialDelaySeconds: 10
  periodSeconds: 10
</pre>

**Backend probe example**
<pre>
readinessProbe:
  httpGet:
    path: /ready
    port: 8080
  initialDelaySeconds: 5
  periodSeconds: 5
</pre>

---

# üîß Environment Variables

**Frontend**
- `REACT_APP_API_URL`: URL de la API (por defecto proxy a localhost:8080)
- `REACT_APP_ENVIRONMENT`: Nombre del entorno a mostrar

**Backend**
- `NODE_ENV`: (development, production)
- `PORT`: Puerto de servicio (por defecto 8080)
- `DATABASE_URL`: Connection string de PostgreSQL
- `REDIS_URL`: Connection string de Redis

---

# üéØ DevOps Testing Focus

Esta app es simple y permite centrarse en:

- Infraestructura como c√≥digo: Terraform en Azure
- Orquestaci√≥n de contenedores: Kubernetes manifests/configuraci√≥n
- Gesti√≥n de paquetes: Helm charts y templating
- CI/CD: GitHub Actions con integraci√≥n Azure
- Observabilidad: Health checks, logging, monitoring

---

# üêõ Troubleshooting Common Issues

**Frontend muestra "Loading..." para siempre**
<pre>
# Verifica si el backend est√° corriendo
curl http://localhost:8080/health
# Revisa errores en la consola del navegador
# Verifica la config de proxy en package.json
</pre>

**Errores en Backend API**
<pre>
# Revisa los logs del backend
docker-compose logs backend
# Verifica variables de entorno
docker-compose exec backend env | grep NODE
</pre>

**Problemas de conexi√≥n a base de datos**
<pre>
# Revisa logs de PostgreSQL
docker-compose logs postgres
# Verifica formato de DATABASE_URL:
# postgresql://user:password@host:port/database
</pre>

**Debug salud**
<pre>
# Test endpoints de salud
curl -v http://localhost:3000/health       # healthy
curl -v http://localhost:8080/health       # status JSON
curl -v http://localhost:8080/ready        # dependencias
</pre>

---

# üìä Monitoring

El endpoint `/metrics` expone m√©tricas como:
<pre>
{
  "uptime": 3661.234,
  "memory": {
    "rss": 45678592,
    "heapTotal": 29360128,
    "heapUsed": 15982736
  },
  "pid": 1,
  "timestamp": "2025-09-04T10:27:00.000Z"
}
</pre>

---

# üîí Security Features

- **Helmet.js**: Security headers
- **CORS**: Configuraci√≥n cross-origin
- **Non-root containers**: Ambos contenedores corren sin root
- **Read-only filesystem**: Donde sea posible
- **No hardcoded secrets**: Uso de variables de entorno

---

# üìà Scaling Considerations

- **Stateless:** Escala horizontalmente sin estado
- **Session storage:** Persistir sesi√≥n en Redis (cuando se implemente)
- **Database:** Servicio PostgreSQL para persistencia de datos
- **CDN:** Frontend puede servirse v√≠a CDN
- **Load balancing:** Backend API es stateless y se balancea f√°cilmente

---
